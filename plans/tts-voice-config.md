# TTS 音色配置與推薦策略

## Edge-TTS 中文音色列表

### 男聲音色

#### 1. zh-CN-YunxiNeural（雲希）
**特點**：
- 年齡：年輕男性（20-30歲）
- 音色：清晰、穩重、略帶磁性
- 語速：中等
- 情感：冷靜、理性
- 適合角色：主角、劍客、學者、冷靜型角色

**LLM Prompt 描述**：
```
雲希（zh-CN-YunxiNeural）：年輕男性音色，聲音清晰穩重帶有磁性，語速適中，
適合表現冷靜理性的角色，如主角、劍客、學者等。
```

#### 2. zh-CN-YunyangNeural（雲揚）
**特點**：
- 年齡：年輕男性（18-25歲）
- 音色：活潑、陽光、充滿活力
- 語速：較快
- 情感：熱情、積極
- 適合角色：少年主角、活潑型角色、熱血少年

**LLM Prompt 描述**：
```
雲揚（zh-CN-YunyangNeural）：年輕男性音色，聲音活潑陽光充滿活力，語速較快，
適合表現熱情積極的角色，如少年主角、熱血少年等。
```

#### 3. zh-CN-YunjianNeural（雲健）
**特點**：
- 年齡：中年男性（35-50歲）
- 音色：成熟、穩重、有威嚴
- 語速：較慢
- 情感：沉穩、權威
- 適合角色：長者、師父、權威人物、反派

**LLM Prompt 描述**：
```
雲健（zh-CN-YunjianNeural）：中年男性音色，聲音成熟穩重帶有威嚴感，語速較慢，
適合表現沉穩權威的角色，如長者、師父、權威人物、反派等。
```

#### 4. zh-CN-YunzeNeural（雲澤）
**特點**：
- 年齡：青年男性（25-35歲）
- 音色：溫和、親切、可靠
- 語速：中等
- 情感：溫暖、友善
- 適合角色：配角、朋友、溫和型角色

**LLM Prompt 描述**：
```
雲澤（zh-CN-YunzeNeural）：青年男性音色，聲音溫和親切可靠，語速適中，
適合表現溫暖友善的角色，如配角、朋友、溫和型角色等。
```

### 女聲音色

#### 5. zh-CN-XiaoxiaoNeural（曉曉）
**特點**：
- 年齡：年輕女性（20-28歲）
- 音色：溫柔、甜美、清澈
- 語速：中等
- 情感：溫柔、善良
- 適合角色：女主、溫柔型女性、公主

**LLM Prompt 描述**：
```
曉曉（zh-CN-XiaoxiaoNeural）：年輕女性音色，聲音溫柔甜美清澈，語速適中，
適合表現溫柔善良的角色，如女主、溫柔型女性、公主等。
```

#### 6. zh-CN-XiaoyiNeural（曉伊）
**特點**：
- 年齡：少女（16-22歲）
- 音色：活潑、可愛、俏皮
- 語速：較快
- 情感：活潑、開朗
- 適合角色：少女、活潑型女性、妹妹型角色

**LLM Prompt 描述**：
```
曉伊（zh-CN-XiaoyiNeural）：少女音色，聲音活潑可愛俏皮，語速較快，
適合表現活潑開朗的角色，如少女、活潑型女性、妹妹型角色等。
```

#### 7. zh-CN-XiaohanNeural（曉涵）
**特點**：
- 年齡：成熟女性（30-45歲）
- 音色：優雅、知性、沉穩
- 語速：較慢
- 情感：優雅、理性
- 適合角色：成熟女性、女強人、長者

**LLM Prompt 描述**：
```
曉涵（zh-CN-XiaohanNeural）：成熟女性音色，聲音優雅知性沉穩，語速較慢，
適合表現優雅理性的角色，如成熟女性、女強人、長者等。
```

#### 8. zh-CN-XiaomengNeural（曉夢）
**特點**：
- 年齡：少女（14-20歲）
- 音色：清純、柔和、夢幻
- 語速：中等偏慢
- 情感：純真、夢幻
- 適合角色：純真少女、仙女、夢幻型角色

**LLM Prompt 描述**：
```
曉夢（zh-CN-XiaomengNeural）：少女音色，聲音清純柔和帶有夢幻感，語速中等偏慢，
適合表現純真夢幻的角色，如純真少女、仙女、夢幻型角色等。
```

#### 9. zh-CN-XiaomoNeural（曉墨）
**特點**：
- 年齡：青年女性（22-30歲）
- 音色：冷靜、理性、專業
- 語速：中等
- 情感：冷靜、專業
- 適合角色：女劍客、冷酷型女性、專業人士

**LLM Prompt 描述**：
```
曉墨（zh-CN-XiaomoNeural）：青年女性音色，聲音冷靜理性專業，語速適中，
適合表現冷靜專業的角色，如女劍客、冷酷型女性、專業人士等。
```

#### 10. zh-CN-XiaoruiNeural（曉睿）
**特點**：
- 年齡：青年女性（25-32歲）
- 音色：聰慧、靈動、機智
- 語速：較快
- 情感：聰明、機智
- 適合角色：智慧型女性、謀士、機智型角色

**LLM Prompt 描述**：
```
曉睿（zh-CN-XiaoruiNeural）：青年女性音色，聲音聰慧靈動機智，語速較快，
適合表現聰明機智的角色，如智慧型女性、謀士、機智型角色等。
```

## LLM 角色分析 Prompt 模板

### 完整 Prompt

```
你是一個專業的小說角色分析助手。請分析以下小說文本，提取主要角色信息並推薦合適的配音音色。

【小說文本】
{novel_text}

【可用音色列表】

男聲音色：
1. 雲希（zh-CN-YunxiNeural）：年輕男性音色，聲音清晰穩重帶有磁性，語速適中，適合表現冷靜理性的角色，如主角、劍客、學者等。
2. 雲揚（zh-CN-YunyangNeural）：年輕男性音色，聲音活潑陽光充滿活力，語速較快，適合表現熱情積極的角色，如少年主角、熱血少年等。
3. 雲健（zh-CN-YunjianNeural）：中年男性音色，聲音成熟穩重帶有威嚴感，語速較慢，適合表現沉穩權威的角色，如長者、師父、權威人物、反派等。
4. 雲澤（zh-CN-YunzeNeural）：青年男性音色，聲音溫和親切可靠，語速適中，適合表現溫暖友善的角色，如配角、朋友、溫和型角色等。

女聲音色：
5. 曉曉（zh-CN-XiaoxiaoNeural）：年輕女性音色，聲音溫柔甜美清澈，語速適中，適合表現溫柔善良的角色，如女主、溫柔型女性、公主等。
6. 曉伊（zh-CN-XiaoyiNeural）：少女音色，聲音活潑可愛俏皮，語速較快，適合表現活潑開朗的角色，如少女、活潑型女性、妹妹型角色等。
7. 曉涵（zh-CN-XiaohanNeural）：成熟女性音色，聲音優雅知性沉穩，語速較慢，適合表現優雅理性的角色，如成熟女性、女強人、長者等。
8. 曉夢（zh-CN-XiaomengNeural）：少女音色，聲音清純柔和帶有夢幻感，語速中等偏慢，適合表現純真夢幻的角色，如純真少女、仙女、夢幻型角色等。
9. 曉墨（zh-CN-XiaomoNeural）：青年女性音色，聲音冷靜理性專業，語速適中，適合表現冷靜專業的角色，如女劍客、冷酷型女性、專業人士等。
10. 曉睿（zh-CN-XiaoruiNeural）：青年女性音色，聲音聰慧靈動機智，語速較快，適合表現聰明機智的角色，如智慧型女性、謀士、機智型角色等。

【分析要求】
請以 JSON 格式返回角色分析結果，包含以下信息：

{
  "characters": [
    {
      "name": "角色名稱",
      "role": "主角/配角/反派",
      "importance": 1-10,
      "gender": "male/female",
      "age_range": "young/middle/old",
      "appearance": "詳細外貌描述（髮色、衣著、體型等）",
      "personality": "性格特點（冷靜/活潑/溫柔/冷酷等）",
      "background": "身份背景（劍客/公主/學者等）",
      "suggested_voice": "推薦的音色ID（如 zh-CN-YunxiNeural）",
      "voice_reason": "推薦理由（為什麼選擇這個音色）",
      "suggested_style": "推薦的圖片風格（anime style/realistic/fantasy等）",
      "base_prompt": "基礎圖片提示詞（用於生成角色圖片）"
    }
  ],
  "analysis_confidence": 0.0-1.0
}

【注意事項】
1. 仔細分析角色的性別、年齡、性格特點
2. 根據角色特徵選擇最匹配的音色
3. 提供清晰的推薦理由
4. 確保外貌描述詳細且適合生成圖片
5. 按角色重要性排序（importance 值）
```

## 音色推薦算法

### Python 實現示例

```python
def recommend_voice(character: dict) -> tuple[str, str]:
    """
    根據角色特徵推薦音色
    
    Args:
        character: 角色信息字典，包含 gender, age_range, personality 等
        
    Returns:
        (voice_id, reason): 音色ID和推薦理由
    """
    gender = character.get('gender', 'male')
    age = character.get('age_range', 'young')
    personality = character.get('personality', '').lower()
    
    # 男聲推薦邏輯
    if gender == 'male':
        if age == 'young':
            if any(word in personality for word in ['冷靜', '理性', '穩重', '劍客']):
                return 'zh-CN-YunxiNeural', '年輕男性，冷靜穩重的特質適合雲希音色'
            elif any(word in personality for word in ['活潑', '熱情', '陽光', '熱血']):
                return 'zh-CN-YunyangNeural', '年輕男性，活潑熱情的特質適合雲揚音色'
            elif any(word in personality for word in ['溫和', '友善', '親切']):
                return 'zh-CN-YunzeNeural', '年輕男性，溫和友善的特質適合雲澤音色'
            else:
                return 'zh-CN-YunxiNeural', '年輕男性，默認使用雲希音色'
        elif age == 'middle' or age == 'old':
            return 'zh-CN-YunjianNeural', '中年或年長男性，成熟穩重適合雲健音色'
    
    # 女聲推薦邏輯
    elif gender == 'female':
        if age == 'young':
            if any(word in personality for word in ['溫柔', '善良', '甜美']):
                return 'zh-CN-XiaoxiaoNeural', '年輕女性，溫柔善良的特質適合曉曉音色'
            elif any(word in personality for word in ['活潑', '可愛', '俏皮', '開朗']):
                return 'zh-CN-XiaoyiNeural', '年輕女性，活潑可愛的特質適合曉伊音色'
            elif any(word in personality for word in ['冷靜', '冷酷', '專業', '劍客']):
                return 'zh-CN-XiaomoNeural', '年輕女性，冷靜專業的特質適合曉墨音色'
            elif any(word in personality for word in ['聰明', '機智', '智慧']):
                return 'zh-CN-XiaoruiNeural', '年輕女性，聰慧機智的特質適合曉睿音色'
            elif any(word in personality for word in ['純真', '夢幻', '仙']):
                return 'zh-CN-XiaomengNeural', '年輕女性，純真夢幻的特質適合曉夢音色'
            else:
                return 'zh-CN-XiaoxiaoNeural', '年輕女性，默認使用曉曉音色'
        elif age == 'middle' or age == 'old':
            return 'zh-CN-XiaohanNeural', '成熟女性，優雅知性適合曉涵音色'
    
    # 默認返回
    return 'zh-CN-YunxiNeural', '默認使用雲希音色'


def get_voice_description(voice_id: str) -> dict:
    """獲取音色的詳細描述"""
    voice_map = {
        'zh-CN-YunxiNeural': {
            'name': '雲希',
            'gender': 'male',
            'age': 'young',
            'traits': ['清晰', '穩重', '磁性', '冷靜', '理性'],
            'suitable_for': ['主角', '劍客', '學者', '冷靜型角色']
        },
        'zh-CN-YunyangNeural': {
            'name': '雲揚',
            'gender': 'male',
            'age': 'young',
            'traits': ['活潑', '陽光', '活力', '熱情', '積極'],
            'suitable_for': ['少年主角', '熱血少年', '活潑型角色']
        },
        'zh-CN-YunjianNeural': {
            'name': '雲健',
            'gender': 'male',
            'age': 'middle',
            'traits': ['成熟', '穩重', '威嚴', '沉穩', '權威'],
            'suitable_for': ['長者', '師父', '權威人物', '反派']
        },
        'zh-CN-YunzeNeural': {
            'name': '雲澤',
            'gender': 'male',
            'age': 'young',
            'traits': ['溫和', '親切', '可靠', '溫暖', '友善'],
            'suitable_for': ['配角', '朋友', '溫和型角色']
        },
        'zh-CN-XiaoxiaoNeural': {
            'name': '曉曉',
            'gender': 'female',
            'age': 'young',
            'traits': ['溫柔', '甜美', '清澈', '善良'],
            'suitable_for': ['女主', '溫柔型女性', '公主']
        },
        'zh-CN-XiaoyiNeural': {
            'name': '曉伊',
            'gender': 'female',
            'age': 'young',
            'traits': ['活潑', '可愛', '俏皮', '開朗'],
            'suitable_for': ['少女', '活潑型女性', '妹妹型角色']
        },
        'zh-CN-XiaohanNeural': {
            'name': '曉涵',
            'gender': 'female',
            'age': 'middle',
            'traits': ['優雅', '知性', '沉穩', '理性'],
            'suitable_for': ['成熟女性', '女強人', '長者']
        },
        'zh-CN-XiaomengNeural': {
            'name': '曉夢',
            'gender': 'female',
            'age': 'young',
            'traits': ['清純', '柔和', '夢幻', '純真'],
            'suitable_for': ['純真少女', '仙女', '夢幻型角色']
        },
        'zh-CN-XiaomoNeural': {
            'name': '曉墨',
            'gender': 'female',
            'age': 'young',
            'traits': ['冷靜', '理性', '專業', '冷酷'],
            'suitable_for': ['女劍客', '冷酷型女性', '專業人士']
        },
        'zh-CN-XiaoruiNeural': {
            'name': '曉睿',
            'gender': 'female',
            'age': 'young',
            'traits': ['聰慧', '靈動', '機智', '聰明'],
            'suitable_for': ['智慧型女性', '謀士', '機智型角色']
        }
    }
    
    return voice_map.get(voice_id, {})
```

## 使用示例

### 示例1：玄幻小說角色

**輸入角色**：
```json
{
  "name": "林軒",
  "gender": "male",
  "age_range": "young",
  "personality": "冷靜、果斷、正義感強",
  "background": "劍客"
}
```

**推薦結果**：
- 音色：zh-CN-YunxiNeural（雲希）
- 理由：年輕男性，冷靜穩重的特質適合雲希音色

### 示例2：都市小說角色

**輸入角色**：
```json
{
  "name": "蘇婉兒",
  "gender": "female",
  "age_range": "young",
  "personality": "溫柔、善良、堅強",
  "background": "白領"
}
```

**推薦結果**：
- 音色：zh-CN-XiaoxiaoNeural（曉曉）
- 理由：年輕女性，溫柔善良的特質適合曉曉音色

### 示例3：仙俠小說角色

**輸入角色**：
```json
{
  "name": "雲夢仙子",
  "gender": "female",
  "age_range": "young",
  "personality": "純真、夢幻、超凡脫俗",
  "background": "仙女"
}
```

**推薦結果**：
- 音色：zh-CN-XiaomengNeural（曉夢）
- 理由：年輕女性，純真夢幻的特質適合曉夢音色

## 配置文件格式

### config/tts_voices.json

```json
{
  "voices": {
    "zh-CN-YunxiNeural": {
      "name": "雲希",
      "gender": "male",
      "age": "young",
      "traits": ["清晰", "穩重", "磁性", "冷靜", "理性"],
      "speed": "medium",
      "suitable_for": ["主角", "劍客", "學者", "冷靜型角色"],
      "description": "年輕男性音色，聲音清晰穩重帶有磁性，語速適中"
    },
    "zh-CN-YunyangNeural": {
      "name": "雲揚",
      "gender": "male",
      "age": "young",
      "traits": ["活潑", "陽光", "活力", "熱情", "積極"],
      "speed": "fast",
      "suitable_for": ["少年主角", "熱血少年", "活潑型角色"],
      "description": "年輕男性音色，聲音活潑陽光充滿活力，語速較快"
    }
  }
}
```

## 總結

這個配置系統確保：
1. ✅ LLM 能夠準確理解每個音色的特點
2. ✅ 推薦算法基於明確的規則
3. ✅ 用戶可以看到推薦理由
4. ✅ 系統易於擴展新音色
5. ✅ 配置清晰且易於維護